# Настройка Telegram-бота для FL Hub

## Общая информация

Telegram-бот используется для авторизации пользователей в приложении FL Hub. Бот также предоставляет базовую информацию о статусе учетной записи пользователя.

## Настройка бота

1. **Токен бота**: Токен бота хранится в файле `.env` в переменной `TELEGRAM_BOT_TOKEN`.
   ```
   TELEGRAM_BOT_TOKEN=7691324824:AAE5yDpAsIDS10gQd3h95Pt_h8K4mEc0BM4
   ```

2. **Домен для виджета**: Для использования Telegram Login Widget необходимо привязать домен к боту. В чате с BotFather выполните команду `/setdomain` и укажите домен. Для локальной разработки можно указать `127.0.0.1`.

   **Примечание**: Настройка домена будет использоваться в следующем этапе при реализации авторизации через Telegram Login Widget.

## Функциональность бота

Бот поддерживает следующие команды:

- `/start` - Начать работу с ботом, получить приветственное сообщение
- `/help` - Получить справку о командах бота
- `/status` - Проверить статус учетной записи пользователя

## Интеграция с приложением

Бот интегрирован с сервером FL Hub следующим образом:

1. **Инициализация**: Бот инициализируется при запуске сервера в файле `server.js`.

2. **API-маршруты**: Доступны следующие API-маршруты для взаимодействия с ботом:
   - `GET /api/telegram/bot-info` - Получить информацию о боте
   - `GET /api/telegram/status` - Проверить статус бота

3. **Модель пользователей**: При первом взаимодействии пользователя с ботом, его данные сохраняются в базе данных с помощью `UserService.findOrCreateUserByTelegram()`.

## Безопасность

- Токен бота должен храниться в секрете и не должен быть опубликован.
- Бот не имеет доступа к конфиденциальной информации пользователей.
- Для авторизации через Telegram Login Widget используется механизм проверки данных, предоставляемый Telegram.

## Тестирование

Для тестирования бота:

1. Запустите сервер:
   ```
   npm run dev
   ```

2. Найдите бота в Telegram по имени пользователя и отправьте команду `/start`.

3. Проверьте, что бот отвечает на команды `/help` и `/status`.

4. Проверьте API-маршруты:
   ```
   http://localhost:5000/api/telegram/status
   http://localhost:5000/api/telegram/bot-info
   ```

## Дальнейшее развитие

В будущем функциональность бота может быть расширена:

- Отправка уведомлений о новом контенте
- Управление подпиской
- Административные команды для пользователей с ролями ADMIN и CEO
